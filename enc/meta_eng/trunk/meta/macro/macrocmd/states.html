<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<title>Состояния - Macros</title>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
<link rel="stylesheet" type="text/css" href="../../../styles/styles.css">
</head>

<body>

<h1>Состояния</h1>
<div class="navbar">
<a href="../../index.html">main</a> |
<a href="../index.html">Macros</a> |
<a href="index.html">Macro-language</a>
</div>

<p class="note"><img src="../../../images/note.gif" alt="ATTENTION!" width="10" height="10"> ATTENTION!</p>
<ul class="note">
  <li>Элементы макроязыка невозможно использовать во время <a href="../macrokey/record.html">записи
    макроса</a> стандартным образом. Добавить элементы языка в макрос
    можно только путем ручной правки реестра или путем применения
    специальных программ/плагинов.</li>
</ul>
<table class="cont">
  <tr class="cont">
    <th class="cont" width="20%">Оператор</th>
    <th class="cont" width="20%">Тип</th>
    <th class="cont" width="60%">Description</th>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.ItemCount">APanel.ItemCount</a><br>
    <a name="PPanel.ItemCount">PPanel.ItemCount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит количество файловых объектов на панели</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.SelСount">APanel.SelСount</a><br>
    <a name="PPanel.SelСount">PPanel.SelСount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит количество выделенных файлов на панели (число)</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.CurPos">APanel.CurPos</a><br>
    <a name="PPanel.CurPos">PPanel.CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит порядковый номер файлового объекта на панели</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.Current">APanel.Current</a><br>
    <a name="PPanel.Current">PPanel.Current</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">содержит имя файла под курсором (строка)</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.Path">APanel.Path</a><br>
    <a name="PPanel.Path">PPanel.Path</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">содержит путь панели (без заключительного '\', исключение: корень диска - всегда оканчивается '\')</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.UNCPath">APanel.UNCPath</a><br>
    <a name="PPanel.UNCPath">PPanel.UNCPath</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">содержит UNC-путь панели (без заключительного '\')</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.Width">APanel.Width</a><br>
    <a name="PPanel.Width">PPanel.Width</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит ширину панели</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.Type">APanel.Type</a><br>
    <a name="PPanel.Type">PPanel.Type</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">содержит тип панели:
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Description</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0</td>
          <td class="cont" width="90%">Файловая панель</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">1</td>
          <td class="cont" width="90%">Дерево папок</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">2</td>
          <td class="cont" width="90%">Панель быстрого просмотра</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">3</td>
          <td class="cont" width="90%">Информационная панель</td>
        </tr>
      </table>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="20%"><a name="APanel.OPIFlags">APanel.OPIFlags</a><br>
    <a name="PPanel.OPIFlags">PPanel.OPIFlags</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">комбинация следующих значений плагиновой панели (если панель не плагиновая, то значение будет = 0):
<table class="cont">
<tr class="cont"><th class="cont" width="10%">Значение</th><th class="cont" width="90%">Description</th></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000001</td>
        <td class="cont" width="90%">используется фильтр на панели</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000002</td>
        <td class="cont" width="90%">используются группы сортировки на панели</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000004</td>
        <td class="cont" width="90%">используется раскраска файлов на панели</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000010</td>
        <td class="cont" width="90%">папки на панели плагина выбираются независимо от настроек FAR</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000020</td>
        <td class="cont" width="90%">используется стандартная обработка файла FAR'ом, если запрошенная операция не поддерживается плагином; если этот флаг указан, элементы на панели плагина являются именами реальных файлов</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000040</td>
        <td class="cont" width="90%">показаны имена без путей</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000080</td>
        <td class="cont" width="90%">имена файлов выровнены по правому краю</td></tr>

        <tr class="cont"><td class="cont" width="10%">0x00000100</td>
        <td class="cont" width="90%">имена файлов показаны в оригинальном регистре (независимо от настроек FAR)</td></tr>

</table>
    </td>
  </tr>

  <tr class="cont">
    <td class="cont" width="20%"><a name="ItemCount">ItemCount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">число элементов в текущем объекте; в меню разделительная черта тоже учитывается</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="CurPos">CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">позиция в текущем объекте</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Dlg.ItemCount">Dlg.ItemCount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">количество элементов диалога</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Dlg.CurPos">Dlg.CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">номер текущего фокусного элемента диалога</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Dlg.ItemType">Dlg.ItemType</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">тип фокусного элемента диалога
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Description</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0</td>
          <td class="cont" width="90%">ошибка, например, Dlg.ItemType вызван не в диалоге</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">1</td>
          <td class="cont" width="90%">Поле ввода</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">2</td>
          <td class="cont" width="90%">Поле ввода пароля</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">3</td>
          <td class="cont" width="90%">Поле ввода фиксированного размера</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">4</td>
          <td class="cont" width="90%">Кнопка (Push Button)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">5</td>
          <td class="cont" width="90%">Контрольный переключатель (Check Box)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">6</td>
          <td class="cont" width="90%">Селекторная кнопка (Radio Button)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">7</td>
          <td class="cont" width="90%">Комбинированный список</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">8</td>
          <td class="cont" width="90%">Окно списка</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">9</td>
          <td class="cont" width="90%">Элемент управления, определяемый программистом</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x8001</td>
          <td class="cont" width="90%">Выбор из истории поля ввода</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x8007</td>
          <td class="cont" width="90%">Выбор из комбинированного списка</td>
        </tr>
      </table>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="CmdLine.ItemCount">CmdLine.ItemCount</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">количество символов в командной строке</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="CmdLine.CurPos">CmdLine.CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">текущая позиция курсора в командной строке</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="CmdLine.Value">CmdLine.Value</a></td>
    <td class="cont" width="20%">String</td>
    <td class="cont" width="60%">содержимое командной строки</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.CurLine">Editor.CurLine</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">номер текущей линии в редакторе</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.CurPos">Editor.CurPos</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">текущая позиция курсора в строке в редакторе</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.Lines">Editor.Lines</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">количество строк в редакторе</td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Editor.State">Editor.State</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">различные состояния текущего редактора - набор
      битовых флагов:
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Description</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000001</td>
          <td class="cont" width="90%">файл совершенно новый либо его успели удалить</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000002</td>
          <td class="cont" width="90%">разрешено переключение на вьювер по F6</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000004</td>
          <td class="cont" width="90%">после закрытия редактора удалить файл</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000008</td>
          <td class="cont" width="90%">редактируемый файл модифицирован (в статусной строке редактора присутствует символ '*')</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000010</td>
          <td class="cont" width="90%">в наличии есть выделенный поточный блок</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000020</td>
          <td class="cont" width="90%">в наличии есть выделенный вертикальный блок</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000040</td>
          <td class="cont" width="90%">редактируемый файл изменялся в сеансе редактирования</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000080</td>
          <td class="cont" width="90%">курсор в режиме замены</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000100</td>
          <td class="cont" width="90%">позиция курсора была изменена плагином</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000200</td>
          <td class="cont" width="90%">редактор заблокирован (ReadOnly)</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000400</td>
          <td class="cont" width="90%">используются постоянные блоки</td>
        </tr>
      </table>
      Например,
      <pre class="code">
$If (Editor.State &amp; 0x8) <em>выполнить действия, если файл модифицирован</em> $End
</pre>
    </td>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Viewer.State">Viewer.State</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">различные состояния текущей программы просмотра -
      набор битовых флагов:
      <table class="cont">
        <tr class="cont">
          <th class="cont" width="10%">Значение</th>
          <th class="cont" width="90%">Description</th>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000001</td>
          <td class="cont" width="90%">включено автоопределение таблицы символов</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000002</td>
          <td class="cont" width="90%">не используются таблицы символов и текст в
            кодировке ANSI</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000004</td>
          <td class="cont" width="90%">режим Unicode</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000008</td>
          <td class="cont" width="90%">включен перенос строк</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000010</td>
          <td class="cont" width="90%">используется перенос строк по словам, а не по
            буквам</td>
        </tr>
        <tr class="cont">
          <td class="cont" width="10%">0x00000020</td>
          <td class="cont" width="90%">выставлен 16-ричный режим</td>
        </tr>
      </table>
      Например,
      <pre class="code">
$If (Viewer.State &amp; 0x20) <em>выполнить действия, если выставлен 16-ричный режим</em> $End
</pre>
    </td>
  </tr>
  <tr class="cont">
    <td class="cont" width="20%"><a name="Far.Width">Far.Width</a></td>
    <td class="cont" width="20%">Number</td>
    <td class="cont" width="60%">ширина консоли, в которой работает FAR Mnager</td>
  </tr>

</table>

</body>

</html>
