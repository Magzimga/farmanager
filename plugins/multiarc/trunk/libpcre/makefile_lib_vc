!ifdef WIDE
DIRSUFF = W
!endif

!IF "$(CPU)" == "AMD64"
DIRBIT = 64
!ELSE
DIRBIT = 32
!ENDIF
OUTDIR = ..\final.$(DIRBIT)$(DIRSUFF).vc

OBJDIR = $(OUTDIR)\obj
OUTPUTS= $(OBJDIR)\pcre.lib
OBJS=$(OBJDIR)\chartables.obj $(OBJDIR)\get.obj $(OBJDIR)\pcre.obj $(OBJDIR)\study.obj

!IF "$(CPU)" == "AMD64"
CFLAGS=/nologo /Zp8 /Wp64 /Fo"$(OBJDIR)\\" /Fd"$(OBJDIR)\\" /c /D WIN32 /D PCRE_STATIC /D _WIN32 /Ox /GS- /Gr /GR- /EHs-c- /LD
!ELSE
CFLAGS=/nologo /Fo"$(OBJDIR)\\" /Fd"$(OBJDIR)\\" /c /D WIN32 /D PCRE_STATIC /D _WIN32 /Ox /Gr /GS- /GR- /EHs-c- /LD
!ENDIF

all: $(OUTPUTS)

.c{$(OBJDIR)}.obj::
	cl @<<
	$(CFLAGS) $<
<<
	
$(OUTPUTS): $(OBJS)
	@lib /nologo /OUT:$(OUTPUTS) $(OBJS)

